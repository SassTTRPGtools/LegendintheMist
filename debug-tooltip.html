<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpecialtyTooltip 調試測試</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 動畫定義 */
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(34, 211, 238, 0.3); }
            50% { box-shadow: 0 0 40px rgba(34, 211, 238, 0.6); }
        }
        @keyframes fade-in {
            0% { opacity: 0; transform: scale(0.95); }
            100% { opacity: 1; transform: scale(1); }
        }
        .animate-glow { animation: glow 2s ease-in-out infinite; }
        .animate-fade-in { animation: fade-in 0.3s ease-out; }
        .animate-pulse-slow { animation: pulse 4s ease-in-out infinite; }
    </style>
</head>
<body class="bg-slate-900 text-white p-8">
    <div id="app">
        <h1 class="text-2xl font-bold mb-6 text-cyan-400">SpecialtyTooltip 調試測試</h1>
        
        <div class="space-y-4">
            <h2 class="text-lg font-semibold text-white">基本測試</h2>
            <div class="p-4 bg-slate-800 rounded-lg">
                <specialty-tooltip
                    name="火焰掌握"
                    description="你能夠操控火焰元素，造成額外的火焰傷害，並且對火焰免疫。這是一個強大的攻擊性專長，適合戰鬥導向的角色。"
                >
                    <span class="inline-flex items-center px-2 py-1 bg-amber-600/20 text-amber-300 rounded text-xs cursor-help border border-amber-500/30 hover:bg-amber-500/30 hover:border-amber-400/50 hover:text-amber-200 hover:shadow-lg hover:shadow-amber-400/20 transition-all duration-200">
                        火焰掌握 (測試)
                    </span>
                </specialty-tooltip>
            </div>
            
            <div class="p-4 bg-slate-800 rounded-lg">
                <specialty-tooltip
                    name="心靈感應"
                    description="你能夠讀取他人的思想並進行心靈交流。在社交場合中獲得優勢，能夠察覺謊言和隱藏的意圖。"
                >
                    <span class="inline-flex items-center px-2 py-1 bg-purple-600/20 text-purple-300 rounded text-xs cursor-help border border-purple-500/30 hover:bg-purple-500/30 hover:border-purple-400/50 hover:text-purple-200 hover:shadow-lg hover:shadow-purple-400/20 transition-all duration-200">
                        心靈感應 (測試)
                    </span>
                </specialty-tooltip>
            </div>
        </div>
        
        <div class="mt-8">
            <h2 class="text-lg font-semibold text-white mb-4">調試信息</h2>
            <div class="p-4 bg-slate-800 rounded-lg text-xs space-y-2">
                <div>Vue 版本: {{ vueVersion }}</div>
                <div>組件掛載狀態: {{ componentMounted ? '已掛載' : '未掛載' }}</div>
                <div>當前時間: {{ currentTime }}</div>
                <div>鼠標事件測試: <span @mouseover="logMouseEvent" class="text-cyan-300 cursor-pointer underline">移動到此處</span></div>
            </div>
        </div>
        
        <div class="mt-4 p-4 bg-red-900/20 border border-red-500/30 rounded-lg">
            <h3 class="text-red-400 font-semibold mb-2">檢查步驟</h3>
            <ol class="text-sm space-y-1 list-decimal list-inside">
                <li>打開瀏覽器開發者工具（F12）</li>
                <li>切換到 Console 標籤</li>
                <li>將鼠標移動到上方的專長標籤上</li>
                <li>觀察是否有 console.log 輸出</li>
                <li>檢查是否出現懸浮提示框</li>
            </ol>
        </div>
    </div>

    <script>
        const { createApp, ref, onMounted } = Vue;
        
        console.log('開始加載 SpecialtyTooltip 測試頁面...');
        
        // SpecialtyTooltip 組件
        const SpecialtyTooltip = {
            template: `
                <div class="inline-block">
                    <!-- 觸發元素插槽 -->
                    <div 
                        @mouseenter="showTooltip"
                        @mouseleave="hideTooltip"
                        class="inline-block"
                    >
                        <slot />
                    </div>
                    
                    <!-- 全域懸浮提示框 -->
                    <teleport to="body">
                        <div 
                            v-if="tooltipData.visible"
                            class="fixed transition-all duration-300 ease-out pointer-events-none z-50"
                            :style="tooltipPosition"
                        >
                            <div class="relative">
                                <!-- 主要提示框 -->
                                <div class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 border-2 border-cyan-400/60 rounded-lg shadow-2xl shadow-cyan-400/20 backdrop-blur-sm w-64 animate-glow">
                                    <!-- 頂部裝飾條與角落裝飾 -->
                                    <div class="relative">
                                        <div class="h-1 bg-gradient-to-r from-transparent via-cyan-400 to-transparent rounded-t-md"></div>
                                        <!-- 左上角科技感裝飾 -->
                                        <div class="absolute top-1 left-2 w-1 h-1 bg-cyan-400 rounded-full animate-pulse"></div>
                                        <!-- 右上角科技感裝飾 -->
                                        <div class="absolute top-1 right-2 w-1 h-1 bg-cyan-400 rounded-full animate-pulse delay-75"></div>
                                    </div>
                                    
                                    <!-- 內容區域 -->
                                    <div class="p-3 space-y-2 relative">
                                        <!-- 背景網格效果 -->
                                        <div class="absolute inset-0 opacity-5" style="background-image: linear-gradient(rgba(34, 211, 238, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(34, 211, 238, 0.1) 1px, transparent 1px); background-size: 8px 8px;"></div>
                                        
                                        <!-- 專長名稱 -->
                                        <div class="relative text-cyan-300 font-bold text-sm tracking-wide border-b border-cyan-400/30 pb-1 flex items-center">
                                            <div class="w-1 h-1 bg-cyan-400 rounded-full mr-2 animate-pulse"></div>
                                            {{ tooltipData.name }}
                                            <div class="ml-auto w-1 h-1 bg-cyan-400 rounded-full animate-pulse delay-150"></div>
                                        </div>
                                        
                                        <!-- 專長描述 -->
                                        <div class="relative text-gray-200 text-xs leading-relaxed pl-3">
                                            <!-- 左側裝飾線 -->
                                            <div class="absolute left-0 top-0 bottom-0 w-px bg-gradient-to-b from-transparent via-cyan-400/50 to-transparent"></div>
                                            {{ tooltipData.description }}
                                        </div>
                                    </div>
                                    
                                    <!-- 底部發光效果與裝飾 -->
                                    <div class="relative">
                                        <div class="h-px bg-gradient-to-r from-transparent via-cyan-400/50 to-transparent"></div>
                                        <!-- 底部角落裝飾 -->
                                        <div class="absolute bottom-1 left-2 w-1 h-1 bg-cyan-400 rounded-full animate-pulse delay-100"></div>
                                        <div class="absolute bottom-1 right-2 w-1 h-1 bg-cyan-400 rounded-full animate-pulse delay-200"></div>
                                    </div>
                                </div>
                                
                                <!-- 外層發光效果 -->
                                <div class="absolute inset-0 bg-cyan-400/10 rounded-lg blur-md -z-10 animate-pulse-slow"></div>
                                
                                <!-- 額外的光暈效果 -->
                                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-cyan-400/5 to-transparent rounded-lg blur-lg -z-20"></div>
                            </div>
                        </div>
                    </teleport>
                </div>
            `,
            props: {
                name: {
                    type: String,
                    required: true
                },
                description: {
                    type: String,
                    required: true
                }
            },
            setup(props) {
                console.log('SpecialtyTooltip setup() called with props:', props);
                
                const tooltipData = ref({
                    visible: false,
                    name: '',
                    description: '',
                    x: 0,
                    y: 0
                });
                
                const tooltipPosition = ref({});
                
                onMounted(() => {
                    console.log('SpecialtyTooltip onMounted() - 組件已掛載，props:', props);
                });
                
                const showTooltip = (event) => {
                    console.log('=== showTooltip 被觸發 ===');
                    console.log('事件對象:', event);
                    console.log('props.name:', props.name);
                    console.log('props.description:', props.description);
                    
                    if (!props.name?.trim() || !props.description?.trim()) {
                        console.warn('❌ showTooltip: 缺少名稱或描述', {
                            name: props.name,
                            description: props.description
                        });
                        return;
                    }
                    
                    const rect = event.target.getBoundingClientRect();
                    console.log('目標元素位置:', rect);
                    
                    const tooltipWidth = 256;
                    const tooltipHeight = 120;
                    const margin = 16;
                    
                    let x = rect.left + rect.width / 2;
                    let y = rect.top - 16;
                    
                    if (x + tooltipWidth / 2 > window.innerWidth - margin) {
                        x = window.innerWidth - tooltipWidth / 2 - margin;
                    }
                    
                    if (x - tooltipWidth / 2 < margin) {
                        x = tooltipWidth / 2 + margin;
                    }
                    
                    if (y - tooltipHeight < margin) {
                        y = rect.bottom + 16;
                    }
                    
                    tooltipData.value = {
                        visible: true,
                        name: props.name,
                        description: props.description,
                        x: x,
                        y: y
                    };
                    
                    tooltipPosition.value = {
                        left: x + 'px',
                        top: y + 'px',
                        transform: 'translate(-50%, -100%)'
                    };
                    
                    console.log('✅ 懸浮提示已設置:', {
                        tooltipData: tooltipData.value,
                        position: tooltipPosition.value
                    });
                };
                
                const hideTooltip = () => {
                    console.log('=== hideTooltip 被觸發 ===');
                    tooltipData.value.visible = false;
                    console.log('✅ 懸浮提示已隱藏');
                };
                
                return {
                    tooltipData,
                    tooltipPosition,
                    showTooltip,
                    hideTooltip
                };
            }
        };
        
        console.log('創建 Vue 應用...');
        
        createApp({
            components: {
                SpecialtyTooltip
            },
            setup() {
                console.log('主應用 setup() 被調用');
                
                const componentMounted = ref(false);
                const vueVersion = Vue.version;
                const currentTime = ref(new Date().toLocaleTimeString());
                
                const logMouseEvent = (event) => {
                    console.log('鼠標事件測試:', event);
                };
                
                // 更新時間
                const updateTime = () => {
                    currentTime.value = new Date().toLocaleTimeString();
                };
                setInterval(updateTime, 1000);
                
                onMounted(() => {
                    console.log('主應用 onMounted() - 應用已掛載');
                    componentMounted.value = true;
                });
                
                return {
                    componentMounted,
                    vueVersion,
                    currentTime,
                    logMouseEvent
                };
            }
        }).mount('#app');
        
        console.log('Vue 應用已啟動');
    </script>
</body>
</html>
